{
  "hash": "f855dd3a27612f32637ea4076b9f0ebc",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Univariate Stock Predictions: LSTM, ARIMA, and prophet\"\nsubtitle: \"INFO 523 - Final Project\"\nauthor: \n  - name: \"Matt Osterhoudt\"\n    affiliations:\n      - name: \"College of Information Science, University of Arizona\"\ndescription: \"Project description\"\nformat:\n   html:\n    code-tools: true\n    code-overflow: wrap\n    embed-resources: true\neditor: visual\nexecute:\n  warning: false\n  echo: false\njupyter: python3\n---\n\n## Abstract\nTime series models can be used to predict track stock data using historical closing values. Importing stock data from Yahoo Finance, we predict MSFT, SPY, and SWPPX by comparing three models: ARIMA (AutoRegressive Integrated Moving Average), LSTM (Long Short-Term Memory Neural Network), and Facebook Prophet. Each model has its strengths, but the LSTM model proved to be the most effective with a high R-squared value across the three stocks (average of .987). The LSTM model also boasted significantly lower Mean Squared Error and Mean Absolute Error when compared to ARIMA and Prophet. This performance conveys that LSTM may prove more effective for moderately long stock predictions and signifies the power of recurring neural networks.\n\n## Introduction/Question\nDriving question: Which time series model (ARIMA, LSTM, or Prophet) is best for univariate (daily closing price) stock price prediction? This project aims to identify the most effective model using three different stock datasets. The stock data used will be MSFT (Microsoft), SPY (SPDR S&P 500 ETF Trust), and SWPPX (Schwab U.S. Large-Cap ETF). The data will range from the beginning of 2015 to the end of 2024. The only relevant variables used from the data will be the closing price and the date index. “Close” is the closing price of the stock per day. The date index will also be referred to in yyyy-mm-day format. By developing these models, our objective is to clarify which model can be utilized or recognized when it comes to predicting stock data.\n\n## Approach\nFirst, I extracted the stock data using the finance package, an API that retrieves stock data from Yahoo Finance. I extracted daily historical data from 2015 to 2024 and retained the “Close” price series as well as the date index for univariate analysis. I did not deem it necessary to preprocess much of the data. This is because there were no outliers I wanted to remove, nor was there missing data outside of holidays and weekends (this is expected). Feature scaling and normalization were performed within certain time series models if necessary. I selected these time series models to deepen my understanding of time series analysis. \n\n\n## ARIMA Approach & Analysis\nFirst, I chose ARIMA (AutoRegressive Integrated Moving Average) for its ability to capture autocorrelated data and patterns after differencing is applied. To help prepare the data, ARIMA requires stationarity tests, which are applied using the ADF (Augmented Dickey-Fuller) test to test raw vs differenced data. If the p-value is less than the significance level (0.05), we may reject the null, implying that the time series data is stationary. If higher than the significant value, we must find the order of differencing. ARIMA also requires ACF(autocorrelation) and PACF(partial autocorrelation) analysis for P and Q lag selections. ACF and PACF are plotted graphically to aid P and Q selection. Determining how ARIMA is configured with these parameters (p, d, q) helps properly fit the model. Each stock's data was split into 80/20 for training and testing. Predicted values were graphically overlaid on the actual test data for visual inspection and confirmation. The ARIMA model did not perform as well as I expected. Despite the P, D, and Q selection tests, my model fell quite short. As seen with all three stocks, it plotted a very linear “prediction” that seems to have simply taken an average. This tells me that the model failed to have any meaningful predictions, or that seasonality played an unexpected role. Limitations or future implementations: address this by utilizing SARIMA or autoarima. I can also do a more thorough check of my model for anything extraneous.\n\n::: {#e9c4abc9 .cell message='false' execution_count=2}\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nDatetimeIndex: 504 entries, 2022-12-29 00:00:00-05:00 to 2024-12-31 00:00:00-05:00\nData columns (total 1 columns):\n #   Column  Non-Null Count  Dtype  \n---  ------  --------------  -----  \n 0   Close   504 non-null    float64\ndtypes: float64(1)\nmemory usage: 7.9 KB\np-value pre-difference: 0.851468950180791\np-value post-difference: 8.881125757309446e-28\n                               SARIMAX Results                                \n==============================================================================\nDep. Variable:                  Close   No. Observations:                 2012\nModel:                 ARIMA(9, 1, 9)   Log Likelihood               -5023.234\nDate:                Thu, 21 Aug 2025   AIC                          10086.468\nTime:                        05:10:29   BIC                          10198.596\nSample:                             0   HQIC                         10127.627\n                               - 2012                                         \nCovariance Type:                  opg                                         \n==============================================================================\n                 coef    std err          z      P>|z|      [0.025      0.975]\n------------------------------------------------------------------------------\nx1             0.0972      0.049      1.997      0.046       0.002       0.193\nar.L1          0.0429      0.072      0.596      0.551      -0.098       0.184\nar.L2         -0.1237      0.070     -1.774      0.076      -0.260       0.013\nar.L3          0.1240      0.067      1.854      0.064      -0.007       0.255\nar.L4         -0.1113      0.057     -1.942      0.052      -0.224       0.001\nar.L5         -0.0750      0.067     -1.122      0.262      -0.206       0.056\nar.L6         -0.0940      0.066     -1.433      0.152      -0.223       0.035\nar.L7          0.1161      0.064      1.808      0.071      -0.010       0.242\nar.L8          0.0825      0.057      1.447      0.148      -0.029       0.194\nar.L9          0.6366      0.064      9.949      0.000       0.511       0.762\nma.L1         -0.1395      0.076     -1.848      0.065      -0.288       0.008\nma.L2          0.1282      0.073      1.758      0.079      -0.015       0.271\nma.L3         -0.1696      0.069     -2.470      0.014      -0.304      -0.035\nma.L4          0.1254      0.063      2.002      0.045       0.003       0.248\nma.L5          0.0784      0.070      1.113      0.266      -0.060       0.217\nma.L6          0.0159      0.069      0.229      0.818      -0.120       0.151\nma.L7         -0.0864      0.069     -1.260      0.208      -0.221       0.048\nma.L8         -0.1734      0.061     -2.866      0.004      -0.292      -0.055\nma.L9         -0.5098      0.070     -7.261      0.000      -0.647      -0.372\nsigma2         8.6375      0.139     62.297      0.000       8.366       8.909\n===================================================================================\nLjung-Box (L1) (Q):                   0.12   Jarque-Bera (JB):              4168.74\nProb(Q):                              0.73   Prob(JB):                         0.00\nHeteroskedasticity (H):              44.73   Skew:                            -0.55\nProb(H) (two-sided):                  0.00   Kurtosis:                         9.97\n===================================================================================\n\nWarnings:\n[1] Covariance matrix calculated using the outer product of gradients (complex-step).\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-2.png){width=649 height=421}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-3.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-4.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-5.png){width=652 height=421}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-6.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-7.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-8.png){width=649 height=421}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\np-value pre-difference: 0.7797883622337182\np-value post-difference: 3.723295626589105e-26\n                               SARIMAX Results                                \n==============================================================================\nDep. Variable:                  Close   No. Observations:                 2012\nModel:                 ARIMA(9, 1, 6)   Log Likelihood               -5248.461\nDate:                Thu, 21 Aug 2025   AIC                          10530.922\nTime:                        05:10:38   BIC                          10626.230\nSample:                             0   HQIC                         10565.907\n                               - 2012                                         \nCovariance Type:                  opg                                         \n==============================================================================\n                 coef    std err          z      P>|z|      [0.025      0.975]\n------------------------------------------------------------------------------\nx1             0.0967      0.076      1.265      0.206      -0.053       0.247\nar.L1         -0.9797      0.183     -5.361      0.000      -1.338      -0.621\nar.L2         -0.1856      0.123     -1.512      0.131      -0.426       0.055\nar.L3          0.1281      0.089      1.440      0.150      -0.046       0.302\nar.L4         -0.5938      0.075     -7.912      0.000      -0.741      -0.447\nar.L5         -1.0189      0.158     -6.449      0.000      -1.329      -0.709\nar.L6         -0.5984      0.115     -5.219      0.000      -0.823      -0.374\nar.L7          0.0263      0.022      1.202      0.229      -0.017       0.069\nar.L8         -0.0269      0.027     -1.002      0.316      -0.080       0.026\nar.L9          0.0238      0.028      0.854      0.393      -0.031       0.078\nma.L1          0.9218      0.182      5.067      0.000       0.565       1.278\nma.L2          0.1441      0.115      1.252      0.211      -0.081       0.370\nma.L3         -0.1178      0.087     -1.354      0.176      -0.288       0.053\nma.L4          0.5709      0.070      8.107      0.000       0.433       0.709\nma.L5          0.9776      0.148      6.596      0.000       0.687       1.268\nma.L6          0.5110      0.104      4.936      0.000       0.308       0.714\nsigma2        10.8318      0.184     58.796      0.000      10.471      11.193\n===================================================================================\nLjung-Box (L1) (Q):                   0.00   Jarque-Bera (JB):              3789.97\nProb(Q):                              0.99   Prob(JB):                         0.00\nHeteroskedasticity (H):               9.57   Skew:                            -0.77\nProb(H) (two-sided):                  0.00   Kurtosis:                         9.54\n===================================================================================\n\nWarnings:\n[1] Covariance matrix calculated using the outer product of gradients (complex-step).\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-10.png){width=649 height=421}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-11.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-12.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-13.png){width=652 height=421}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-14.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-15.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-16.png){width=649 height=421}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\np-value pre-difference: 0.8497185767162418\np-value post-difference: 3.048167252480017e-26\n                               SARIMAX Results                                \n==============================================================================\nDep. Variable:                  Close   No. Observations:                 2012\nModel:                 ARIMA(2, 1, 2)   Log Likelihood                2236.498\nDate:                Thu, 21 Aug 2025   AIC                          -4460.997\nTime:                        05:10:42   BIC                          -4427.359\nSample:                             0   HQIC                         -4448.649\n                               - 2012                                         \nCovariance Type:                  opg                                         \n==============================================================================\n                 coef    std err          z      P>|z|      [0.025      0.975]\n------------------------------------------------------------------------------\nx1             0.0030      0.002      1.739      0.082      -0.000       0.006\nar.L1         -1.7065      0.023    -74.387      0.000      -1.752      -1.662\nar.L2         -0.8990      0.021    -42.462      0.000      -0.940      -0.857\nma.L1          1.6351      0.027     60.685      0.000       1.582       1.688\nma.L2          0.8426      0.025     34.131      0.000       0.794       0.891\nsigma2         0.0063   8.21e-05     77.277      0.000       0.006       0.007\n===================================================================================\nLjung-Box (L1) (Q):                   0.05   Jarque-Bera (JB):             10630.26\nProb(Q):                              0.81   Prob(JB):                         0.00\nHeteroskedasticity (H):              16.20   Skew:                            -0.04\nProb(H) (two-sided):                  0.00   Kurtosis:                        14.26\n===================================================================================\n\nWarnings:\n[1] Covariance matrix calculated using the outer product of gradients (complex-step).\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-18.png){width=641 height=421}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-19.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-20.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-21.png){width=656 height=421}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-22.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-23.png){width=665 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-24.png){width=641 height=421}\n:::\n:::\n\n\n## LSTM Approach & Analysis\nNext, I selected LSTM for its capability of modeling sequential data (in this case, time series stock). LSTM does not use linear modeling; instead, it learns patterns within its observed cell states. In this model, I normalized the data for efficiency and to prevent scaling issues. I used TensorFlow and devised a predictive pattern per 60 days. In simple terms, the LSTM model uses the previous 60 days to predict a single day’s stock price. This is iterated over the entire stock’s data. The sequential model is then constructed with 50 units of internal memory cells and 8 neurons using Rectified Linear Unit (ReLU), a neural network function. The model is trained on a batch size of 32 samples and is passed through the training set 20 times (epoch of 20). I am not (yet) particularly well-versed in neural network machine learning. Many of the variable number selections (20 epochs, 32 samples, 50 units of internal memory cells, etc.) are fundamental values I selected based on conventional practice. Because this LSTM model is sequenced several times, I also included a Model Checkpoint that will keep the best-performing model. The data was also partitioned into 80/20 for training and testing purposes. The models seen here are running very well. As seen visually, the predicted values are very closely aligned with the actual values. I believe that the LSTM models did a much more thorough job based on its iterative function.\n\n::: {#47d0fe07 .cell message='false' execution_count=3}\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential\"</span>\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> Layer (type)                    </span>┃<span style=\"font-weight: bold\"> Output Shape           </span>┃<span style=\"font-weight: bold\">       Param # </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ lstm (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">LSTM</span>)                     │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">50</span>)             │        <span style=\"color: #00af00; text-decoration-color: #00af00\">10,400</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dropout (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)               │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">50</span>)             │             <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dense (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                   │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>)              │           <span style=\"color: #00af00; text-decoration-color: #00af00\">408</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dense_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                 │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)              │             <span style=\"color: #00af00; text-decoration-color: #00af00\">9</span> │\n└─────────────────────────────────┴────────────────────────┴───────────────┘\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">10,817</span> (42.25 KB)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">10,817</span> (42.25 KB)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bold\"> 1/16</span> <span class=\"ansi-green-fg\">━</span><span class=\"ansi-white-fg\">━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">1s</span> 117ms/step\n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">14/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━</span><span class=\"ansi-white-fg\">━━━</span> <span class=\"ansi-bold\">0s</span> 4ms/step  \n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">16/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">0s</span> 11ms/step\n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">16/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">0s</span> 11ms/step\n</pre>\n```\n:::\n\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-7.png){width=669 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential_1\"</span>\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> Layer (type)                    </span>┃<span style=\"font-weight: bold\"> Output Shape           </span>┃<span style=\"font-weight: bold\">       Param # </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ lstm_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">LSTM</span>)                   │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">50</span>)             │        <span style=\"color: #00af00; text-decoration-color: #00af00\">10,400</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dropout_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)             │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">50</span>)             │             <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dense_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                 │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>)              │           <span style=\"color: #00af00; text-decoration-color: #00af00\">408</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dense_3 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                 │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)              │             <span style=\"color: #00af00; text-decoration-color: #00af00\">9</span> │\n└─────────────────────────────────┴────────────────────────┴───────────────┘\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">10,817</span> (42.25 KB)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">10,817</span> (42.25 KB)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bold\"> 1/16</span> <span class=\"ansi-green-fg\">━</span><span class=\"ansi-white-fg\">━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">1s</span> 112ms/step\n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">15/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━</span><span class=\"ansi-white-fg\">━━</span> <span class=\"ansi-bold\">0s</span> 4ms/step  \n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">16/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">0s</span> 11ms/step\n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">16/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">0s</span> 12ms/step\n</pre>\n```\n:::\n\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-14.png){width=669 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential_2\"</span>\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃<span style=\"font-weight: bold\"> Layer (type)                    </span>┃<span style=\"font-weight: bold\"> Output Shape           </span>┃<span style=\"font-weight: bold\">       Param # </span>┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ lstm_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">LSTM</span>)                   │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">50</span>)             │        <span style=\"color: #00af00; text-decoration-color: #00af00\">10,400</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dropout_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)             │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">50</span>)             │             <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dense_4 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                 │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>)              │           <span style=\"color: #00af00; text-decoration-color: #00af00\">408</span> │\n├─────────────────────────────────┼────────────────────────┼───────────────┤\n│ dense_5 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                 │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)              │             <span style=\"color: #00af00; text-decoration-color: #00af00\">9</span> │\n└─────────────────────────────────┴────────────────────────┴───────────────┘\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">10,817</span> (42.25 KB)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">10,817</span> (42.25 KB)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n</pre>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bold\"> 1/16</span> <span class=\"ansi-green-fg\">━</span><span class=\"ansi-white-fg\">━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">1s</span> 113ms/step\n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">15/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━</span><span class=\"ansi-white-fg\">━━</span> <span class=\"ansi-bold\">0s</span> 4ms/step  \n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">16/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">0s</span> 11ms/step\n\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n<span class=\"ansi-bold\">16/16</span> <span class=\"ansi-green-fg\">━━━━━━━━━━━━━━━━━━━━</span> <span class=\"ansi-bold\">0s</span> 11ms/step\n</pre>\n```\n:::\n\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-21.png){width=660 height=449}\n:::\n:::\n\n\n## Prophet Approach & Analysis\nFinally, Prophet is the last model I am implementing. Prophet expects a data frame that consists of two columns: commonly known as “ds” (timestamps, or in other words, date) and “y” (target variable, in my case, daily closing prices). For the most part, my data is already in this format. The only thing I had to implement later was stripping the timezone. Unlike LSTM, this model is linear and is an additive model. Seasonality is a specific feature that this model anticipates. Our stock data is computed daily over around 9 years, so I select the yearly seasonality to be true and the weekly and daily to be false. Another feature of this model is the setting “freq = b”, which removes weekends and holidays. The performance of this model was interesting. Prophet’s predictive power seemed to be only potent for trends it notices. For example, in the graphs shown for SWPPX and SPY, I partitioned the data into 80/20. The location of the partitioned training/test set happens to be where the tail end of a decrease in stock price occurred. The model saw the decreasing trend and continued to predict that it would decrease. However, for MSFT, I changed the set to 90/10, in which some of the training data included the new upward trend past 2023. The MSFT model instead projected more upwards, indicating that the model relied more on short-term trends to predict values. In addition to this, Prophet includes components that can be plotted. I plotted the trend and yearly movements as well.\n\n::: {#8eccc7ce .cell message='false' execution_count=4}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-1.png){width=649 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-2.png){width=851 height=592}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-3.png){width=641 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-4.png){width=851 height=592}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-5.png){width=649 height=449}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-6.png){width=851 height=592}\n:::\n:::\n\n\n## Discussion & Model Comparison\nI computed the R-squared, Mean Squared Error (MSE), Mean Absolute Error(MAE), and the normalized MSE and MAR (NMAE and NMSE, respectively). As provided in the matrix below, these values reflect the statistical significance of the models. LSTM proved to be the most effective model, with very low NMSE, NMAE, MSE, and MAR values across all 3 stocks. It also had an R-squared value of almost 1.00 across the 3 stocks as well. Prophet and ARIMA both struggled to predict stock values in an effective way. They both had higher MSE and MAE values, and the R-squared across all stocks in both ARIMA and Prophet were negative. This implies that ARIMA may have struggled with nonstationarity (may be an oversight on my end) or seasonality, whereas Prophet may have failed due to overfitting of training or failure to capture market volatility.\n\n\n\n| Stock   | Model   |     MSE    |   MAE    |    R²     |  NMSE   |  NMAE   |\n|---------|---------|------------|----------|-----------|---------|---------|\n| MSFT    | Prophet | 4591.333   | 65.959   | -12.971   | 11.021  | 0.158   |\n| MSFT    | ARIMA   | 13585.598  | 105.661  | -2.431    | 37.437  | 0.291   |\n| MSFT    | LSTM    | 63.961     | 6.459    | 0.982     | 0.018   | 0.018   |\n| SWPPX   | Prophet | 18.707     | 3.719    | -4.200    | 1.693   | 0.337   |\n| SWPPX   | ARIMA   | 8.303      | 2.365    | -1.056    | 0.742   | 0.211   |\n| SWPPX   | LSTM    | 0.033      | 0.132    | 0.992     | 0.008   | 0.012   |\n| SPY     | Prophet | 21337.151  | 122.298  | -4.163    | 45.381  | 0.260   |\n| SPY     | ARIMA   | 10072.653  | 84.816   | -1.219    | 21.212  | 0.179   |\n| SPY     | LSTM    | 63.426     | 6.268    | 0.986     | 0.014   | 0.013   |\n\n\n## Conclusion & Limitations\nOverall, LSTM was the best-performing model by far. Based on the trend of stock data it was receiving, it was able to accurately map temporal dependencies. LSTM, however, did take the longest to compute. This is something that should be considered. I did not specifically dive into the time used of each model, but LSTM was the longest by far. I think that there are certainly improvements that can be made. For example, with ARIMA or Prophet, perhaps testing month to month data over a single year may produce better results. I could have also used different stock data, and my models were limited to only three. For ARIMA, I specifically could have referenced or used SARIMA or AutoArima to test for the best parameters. I did implement the P, Q, and D test myself, and could have gone amiss there. I only referenced univariate analysis as well. I examined the closing price and nothing else. While this is most likely a very big factor, there could be a myriad of other factors at play as well. Perhaps a multivariate analysis that incorporates more features would yield more interesting results.\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}